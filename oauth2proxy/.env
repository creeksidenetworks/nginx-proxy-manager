################################################################################
# USER CONFIGURATION - Update these values for your environment
################################################################################

# Domain configuration
DEFAULT_DOMAIN=.yourdomain.com

# Generic AAD application settings
APP_COOKIE_NAME=npm-app-cookie
APP_COOKIE_SECRET=changeme_app_secret
APP_AAD_CLIENT_ID=changeme_app_client_id
APP_AAD_CLIENT_SECRET=changeme_app_client_secret
AAD_TENANT_ID=changeme_tenant_id
APP_AUTH_URL=auth.yourdomain.com

################################################################################
# OAuth2 Proxy Configuration
################################################################################

# Server settings
OAUTH2_PROXY_HTTP_ADDRESS=0.0.0.0:4180
OAUTH2_PROXY_REVERSE_PROXY=true

# Cookie settings
OAUTH2_PROXY_COOKIE_SAMESITE=lax
OAUTH2_PROXY_COOKIE_CSRF_PER_REQUEST=true
OAUTH2_PROXY_COOKIE_CSRF_EXPIRE=5m
OAUTH2_PROXY_COOKIE_SECRET=${APP_COOKIE_SECRET}
OAUTH2_PROXY_COOKIE_NAME=${APP_COOKIE_NAME}
OAUTH2_PROXY_COOKIE_SECURE=false
OAUTH2_PROXY_COOKIE_EXPIRE=12h
OAUTH2_PROXY_COOKIE_DOMAINS=${DEFAULT_DOMAIN}

# Session and request handling
OAUTH2_PROXY_SKIP_PROVIDER_BUTTON=true
OAUTH2_PROXY_PASS_USER_HEADERS=true
OAUTH2_PROXY_SET_XAUTHREQUEST=true

# Redis session storage
OAUTH2_PROXY_SESSION_STORE_TYPE=redis
OAUTH2_PROXY_REDIS_CONNECTION_URL=redis://redis:6379

# Domain configuration
OAUTH2_PROXY_WHITELIST_DOMAINS=${DEFAULT_DOMAIN}

# Azure provider configuration
OAUTH2_PROXY_PROVIDER=azure
OAUTH2_PROXY_CLIENT_ID=${APP_AAD_CLIENT_ID}
OAUTH2_PROXY_CLIENT_SECRET=${APP_AAD_CLIENT_SECRET}
OAUTH2_PROXY_EMAIL_DOMAINS=*
OAUTH2_PROXY_AZURE_TENANT=${AAD_TENANT_ID}
OAUTH2_PROXY_OIDC_ISSUER_URL=https://login.microsoftonline.com/${AAD_TENANT_ID}/v2.0
OAUTH2_PROXY_REDIRECT_URL=https://${APP_AUTH_URL}/oauth2/callback

# User claim configuration (for non-email users)
OAUTH2_PROXY_OIDC_EMAIL_CLAIM=upn
OAUTH2_PROXY_OIDC_USER_CLAIM=upn
OAUTH2_PROXY_SCOPE=openid profile email

# Debug settings
OAUTH2_PROXY_SHOW_DEBUG_ON_ERROR=true

